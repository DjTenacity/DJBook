# 01 “架构”到底指什么

> 架构是顶层设计；框架是面向编程或配置的半成品；组件是从技术维度上的复用；模块是从业务维度上职责的划分；系统是相互协同可运行的实体。

架构和框架是什么关系？有什么区别？ 

Linux 有架构，MySQL 有架构，JVM 也有架构，使用 Java 开发、MySQL 存储、跑在 

Linux 上的业务系统也有架构，应该关注哪个架构呢？ 

微信有架构，微信的登录系统也有架构，微信的支付系统也有架构，当我们谈微信架构时，到底是在谈什么架构？

要想准确地回答这几个问题，关键在于梳理几个有关系而又相似的概念，包括：系统与子系统、模块与组件、框架与架构。



### **系统与子系统** 

我们先来看维基百科定义的“系统”。 

系统泛指由一群有关联的个体组成，根据某种规则运作，能完成个别元件不能单独完成的工作的群体。它的意思是“总体”“整体”或“联盟”。 

我来提炼一下里面的关键内容： 

1. **关联**：**系统是由一群有关联的个体组成的，没有关联的个体堆在一起不能成为一个系统**。例如，把一个发动机和一台 PC 放在一起不能称之为一个系统，把发动机、底盘、 轮胎、车架组合起来才能成为一台汽车。 

2. **规则**：**系统内的个体需要按照指定的规则运作，而不是单个个体各自为政。规则规定了 系统内个体分工和协作的方式。**例如，汽车发动机负责产生动力，然后通过变速器和传动轴，将动力输出到车轮上，从而驱动汽车前进。 

3. **能力**：**系统能力与个体能力有本质的差别，系统能力不是个体能力之和，而是产生了新的能力。**例如，汽车能够载重前进，而发动机、变速器、传动轴、车轮本身都不具备这 样的能力。 

### 我们再来看子系统的定义

子系统也是由一群有关联的个体所组成的系统，多半会是更大系统中的一部分。 

其实子系统的定义和系统定义是一样的，只是观察的角度有差异，**一个系统可能是另外一个更大系统的子系统。** 

按照这个定义，系统和子系统比较容易理解。我们以微信为例来做一个分析。 

1. 微信本身是一个系统，包含聊天、登录、支付、朋友圈等子系统。 

2. 朋友圈这个系统又包括动态、评论、点赞等子系统。 

3. 评论这个系统可能又包括防刷子系统、审核子系统、发布子系统、存储子系统。 

4. 评论审核子系统不再包含业务意义上的子系统，而是包括各个模块或者组件，这些模块或者组件本身也是另外一个维度上的系统。例如，MySQL、Redis 等是存储系统，但不 是业务子系统。 

### **模块与组件**

模块与组件的定义并不好理解，也不能很好地进行区分。我们来看看这两者在维基百科上的定义。

>  软件模块（Module）是一套一致而互相有紧密关连的软件组织。它分别包含了程序和数据结构两部分。现代软件开发往往利用模块作为合成的单位。模块的接口表达了由该模块提供的功能和调用它时所需的元素。模块是可能分开被编写的单位。这使它们可再用和允许人员同时协作、编写及研究不同的模块。 
>
> 软件组件定义为自包含的、可编程的、可重用的、与语言无关的软件单元，软件组件可以很容易被用于组装应用程序中。  

可能你看完这两个定义后一头雾水，还是不知道这两者有什么区别。造成这种现象的根本原因是，**模块和组件都是系统的组成部分，只是从不同的角度拆分系统而已**。

从逻辑的角度来拆分系统后，得到的单元就是“模块”；

从物理的角度来拆分系统后，得到的单元就是“组件”。



**划分模块的主要目的是职责分离；划分组件的主要目的是单元复用。**

其实，“组件”的英文 component 也可翻译成中文的“零件”一词，“零件”更容易理解一些，“零件”是一个物理的概念，并且具备“独立且可替换”的特点。

### **框架与架构** 

**软件框架（Software framework）通常指的是为了实现某个业界标准或完成特定基本任务的软件组件规范，也指为了实现某个软件组件规范时，提供规范所要求之基础功能的软件产品。** 

我来提炼一下其中关键部分： 

1. **框架是组件规范**：例如，MVC 就是一种最常见的开发规范，类似的还有 MVP、MVVM、J2EE 等框架。 

2. **框架提供基础功能的产品**：例如，Spring MVC 是 MVC 的开发框架，除了满足 MVC 的规范，Spring 提供了很多基础功能来帮助我们实现功能，包括注解（@Controller 等）、Spring Security、Spring JPA 等很多基础功能。 

**软件架构指软件系统的“基础结构”，创造这些基础结构的准则，以及对这些结构的描述**。 

单纯从定义的角度来看，框架和架构的区别还是比较明显的，**框架关注的是“规范”，架构关注的是“结构”**。

采用不同的角度或者维度，可以将系统 划分为不同的结构，

![](D:\DJGitBook\架构\img\什么是架构_1.jpg)

![](D:\DJGitBook\架构\img\什么是架构_2.jpg)

这些“架构”，都是“学生管理系统”正确的架构，只是从不同的角度来分解而已，这也是 

IBM 的 RUP 将软件架构视图分为著名的“**4+1 视图**”的原因。



## 重新定义架构

参考维基百科的定义，将架构重新定义为：**软件架构指软件系统的顶层结构**。

这个定义看似很简单，但包含的信息很丰富，基本上把系统、子系统、模块、组件、架构等概念都串起来了，我来详细解释一下。

首先，“系统是一群关联个体组成”，这些“个体”可以是“子系统”“模块”“组件”等；架构需要明确系统包含哪些“个体”。

其次，系统中的个体需要“根据某种规则”运作，架构需要明确个体运作和协作的规则。

第三，维基百科定义的架构用到了“基础结构”这个说法，我改为“顶层结构”，可以更好地区分系统和子系统，避免将系统架构和子系统架构混淆在一起导致架构层次混乱。



## 历史背景



卡内基·梅隆大学的玛丽·肖（Mary Shaw）和戴维·加兰（David Garlan）对软件架构做了很多研究，他们在 1994 年的一篇文章《软件架构介绍》（An Introduction to Software Architecture）中写到：

> “When systems are constructed from many components, the organization of the overall system-the software architecture-presents a new set of design problems.”

简单翻译一下：随着软件系统规模的增加，计算相关的算法和数据结构不再构成主要的设计问题；当系统由许多部分组成时，整个系统的组织，也就是所说的“软件架构”，导致了一系列新的设计问题。

这段话很好地解释了“软件架构”为何先在 Rational 或者 Microsoft 这样的大公司开始逐步流行起来。因为只有大公司开发的软件系统才具备较大规模，而只有规模较大的软件系统才会面临软件架构相关的问题，例如：

- 系统规模庞大，内部耦合严重，开发效率低；
- 系统耦合严重，牵一发动全身，后续修改和扩展困难；
- 系统逻辑复杂，容易出问题，出问题后很难排查和修复。

软件架构的出现有其历史必然性。20 世纪 60 年代第一次软件危机引出了“结构化编程”，创造了“模块”概念；20 世纪 80 年代第二次软件危机引出了“面向对象编程”，创造了“对象”概念；到了 20 世纪 90 年代“软件架构”开始流行，创造了“组件”概念。我们可以看到，“模块”“对象”“组件”本质上都是对达到一定规模的软件进行拆分，差别只是在于随着软件的复杂度不断增加，拆分的粒度越来越粗，拆分的层次越来越高。